= form_with model: @item, url: lexicon_update_section_verification_path(@entry), method: :patch, local: false, html: { class: 'verification-edit-form' } do |f|
  = hidden_field_tag :section, 'title'

  .form-group
    = label_tag :entry_title, t('activerecord.attributes.lex_entry.title'), class: 'form-label'
    = text_field_tag :entry_title, @entry.title, class: 'form-control', required: true

  .form-group
    = label_tag :english_title, t('activerecord.attributes.lex_entry.english_title'), class: 'form-label'
    = text_field_tag :english_title, @entry.english_title, class: 'form-control'

  - if @item.is_a?(LexPerson)
    .form-group
      = label_tag :authority_autocomplete, t('activerecord.attributes.lex_person.authority'), class: 'form-label'
      = text_field_tag 'authority_autocomplete',
                       @item.authority&.name,
                       class: 'form-control',
                       data: { autocomplete: autocomplete_authority_name_and_aliases_path }
      = f.hidden_field :authority_id, value: @item.authority_id

    .form-group
      = f.label :birthdate, t('activerecord.attributes.lex_person.birthdate'), class: 'form-label'
      = f.text_field :birthdate, class: 'form-control'

    .form-group
      = f.label :deathdate, t('activerecord.attributes.lex_person.deathdate'), class: 'form-label'
      = f.text_field :deathdate, class: 'form-control'

    .form-group
      = f.label :gender, t('activerecord.attributes.lex_person.gender'), class: 'form-label'
      = f.select :gender, options_for_select([[t('male'), 'male'], [t('female'), 'female'], [t('other'), 'other'], [t('unknown'), 'unknown']], @item.gender), { include_blank: true }, class: 'form-control'

  .form-check.mt-3
    = check_box_tag :mark_verified, '1', false, class: 'form-check-input'
    = label_tag :mark_verified, t('lexicon.verification.edit.mark_as_verified'), class: 'form-check-label'

  .modal-footer
    %button.btn.btn-secondary{ type: 'button', data: { dismiss: 'modal' } }
      = t('cancel')
    = f.submit t('save'), class: 'btn btn-primary'

:javascript
  (function() {
    var $autocomplete = $('#authority_autocomplete');
    var autocompleteUrl = $autocomplete.data('autocomplete');

    if ($autocomplete.length && autocompleteUrl) {
      $autocomplete.autocomplete({
        source: autocompleteUrl,
        minLength: 2,
        select: function(event, ui) {
          $('#lex_person_authority_id').val(ui.item.id);
          return true;
        }
      });
    }
  })();
